<script type="text/html" id="Zvalue">
	<span  data-bind="text: '&nbsp;'+$data.v.toFixed($data.n), style: {'color': $data.v > 0 ? 'red': ($data.v < 0 ? 'blue' : 'black')}"></span>
</script>
<script type="text/html" id="Zdegree">
	<span  data-bind="text: '&nbsp;'+Math.abs($data.v).toFixed($data.n), style: {'color': $data.v > 0 ? 'red': ($data.v < 0 ? 'blue' : 'black')}, attr: {'title': $data.v > 0 ? 'turn anticlockwise': ($data.v < 0 ? 'turn clockwise' : 'perfect')}"></span>
</script>

<div class="container span12">
	<div class="tabbable">
		<h4>Bed Visualizer Settings</h4>
		<ul class="nav nav-tabs" id="bedlevelvisualizer_tabs">
			<li class="active"><a data-toggle="tab" href="#bedlevelvisualizer_general">General</a></li>
			<li><a data-toggle="tab" href="#bedlevelvisualizer_stored_data">Stored Data</a></li>
			<li><a data-toggle="tab" href="#bedlevelvisualizer_corrections">Adjustment Wheel Degrees</a></li>
		</ul>
		<div class="tab-content">
			<div id="bedlevelvisualizer_general" class="tab-pane active">
				<div class="control-group">
					<label for="bedlevelvisualizer_command"><i class="icon icon-info-sign" title="GCODE commands to send to printer to retrieve grid data" data-toggle="tooltip"></i> GCODE Commands</label>
					<textarea class="input-block-level" id="bedlevelvisualizer_command" rows="4" data-bind="value: settingsViewModel.settings.plugins.bedlevelvisualizer.command"></textarea>
					<p style="padding-top: 5px;">If you experience issues with data collection try entering <span class="label">@BEDLEVELVISUALIZER</span> just prior to the command that sends back the mesh data.</p>
				</div>
				<div class="row-fluid">
					<div class="control-group span4">
						<i class="icon icon-info-sign" title="Save/Load mesh data to/from config.yaml" data-toggle="tooltip"></i> Save Mesh <input class="input-checkbox" type="checkbox" id="bedlevelvisualizer_save_mesh" data-bind="checked: settingsViewModel.settings.plugins.bedlevelvisualizer.save_mesh" style="display: inline-block;margin-bottom: 5px;"></input>
					</div>
					<div class="control-group span4">
						<i class="icon icon-info-sign" title="Flip the mesh data in the X direction." data-toggle="tooltip"></i> Flip X Axis <input class="input-checkbox" type="checkbox" id="bedlevelvisualizer_flipX" data-bind="checked: settingsViewModel.settings.plugins.bedlevelvisualizer.flipX" style="display: inline-block;margin-bottom: 5px;"></input>
					</div>
					<div class="control-group span4">
						<i class="icon icon-info-sign" title="Make origin point center of bed." data-toggle="tooltip"></i> Use Center Origin <input class="input-checkbox" type="checkbox" id="bedlevelvisualizer_use_center_origin" data-bind="checked: settingsViewModel.settings.plugins.bedlevelvisualizer.use_center_origin" style="display: inline-block;margin-bottom: 5px;"></input>
					</div>
				</div>
				<div class="row-fluid">
					<div class="control-group span4">
						<i class="icon icon-info-sign" title="Remove row labeling from mesh data." data-toggle="tooltip"></i> Remove Row Labels <input class="input-checkbox" type="checkbox" id="bedlevelvisualizer_stripFirst" data-bind="checked: settingsViewModel.settings.plugins.bedlevelvisualizer.stripFirst" style="display: inline-block;margin-bottom: 5px;"></input>
					</div>
					<div class="control-group span4">
						<i class="icon icon-info-sign" title="Flip the mesh data in the Y direction." data-toggle="tooltip"></i> Flip Y Axis <input class="input-checkbox" type="checkbox" id="bedlevelvisualizer_flipY" data-bind="checked: settingsViewModel.settings.plugins.bedlevelvisualizer.flipY" style="display: inline-block;margin-bottom: 5px;"></input>
					</div>
					<div class="control-group span4">
						<i class="icon icon-info-sign" title="Make all z offsets relative to origin point." data-toggle="tooltip"></i> Use Relative Z Offsets <input class="input-checkbox" type="checkbox" id="bedlevelvisualizer_use_relative_offsets" data-bind="checked: settingsViewModel.settings.plugins.bedlevelvisualizer.use_relative_offsets" style="display: inline-block;margin-bottom: 5px;"></input>
					</div>
				</div>
				<div class="row-fluid">
					<div class="control-group">
						<label for="bedlevelvisualizer_timeout"><i class="icon icon-info-sign" title="Timeout value that will stop processing of visualizer in seconds." data-toggle="tooltip"></i> Timeout</label>
						<div class="input-append">
							<input type="number" min="0" step="10" id="bedlevelvisualizer_timeout" class="input-mini text-right" data-bind="value: settingsViewModel.settings.plugins.bedlevelvisualizer.timeout">
							<span class="add-on">secs</span>
						</div>
					</div>
				</div>
				<div class="row-fluid">
					<div class="control-group">
						<i class="icon icon-info-sign" title="Ignore Bed Level Correction Matrix by enabling this option." data-toggle="tooltip"></i> Ignore Bed Level Correction Matrix: <input class="input-checkbox" type="checkbox" id="ignore_correction_matrix" data-bind="checked: settingsViewModel.settings.plugins.bedlevelvisualizer.ignore_correction_matrix" style="display: inline-block;margin-bottom: 5px;"></input>
					</div>
				</div>
			</div>
			<div id="bedlevelvisualizer_stored_data" class="tab-pane">
				<table>
					<thead>
						<tr>
							<th style="text-align: right; background-color:#f2f2f2;" >mm</th>
							<!-- ko foreach:  { data: $root.settingsViewModel.settings.plugins.bedlevelvisualizer.stored_mesh_x(), as: 'Xaxis', noChildContext: true }-->
								<th style="text-align: right; background-color:#f2f2f2; color: green;" data-bind="text: Xaxis"></th>
							<!-- /ko -->
						</tr>
					</thead>
					<tbody>
						<!-- ko foreach: { data: $root.settingsViewModel.settings.plugins.bedlevelvisualizer.stored_mesh(), as: 'Yaxis', noChildContext: true }-->
						<tr>
							<td style="text-align: right; font-weight: bold; background-color:#f2f2f2;" data-bind="text: $root.settingsViewModel.settings.plugins.bedlevelvisualizer.stored_mesh_y()[$index()]"></td>
							<!-- ko foreach:  { data: Yaxis, as: 'Zvalue', noChildContext: true }-->
								<td style="text-align: right;" data-bind="template: {name: 'Zvalue', data: {v:parseFloat(Zvalue), n:3, c:0}}">.</td>
							<!-- /ko -->
						</tr>
						<!-- /ko -->
					</tbody>
				</table>
				<div style="padding-top: 5px;" class="row-fluid">
					<span style="font-weight: bold; color: green;">X - Position</span>
					<span style="font-weight: bold; color: normal;">Y - Position</span>
				<div class="row-fluid">
				</div>
					<span style="color: normal;">Z - </span>
					<span style="color: blue;">below offset</span>
					<span style="color: normal;"> / </span>
					<span style="color: red;">above offset</span>
				</div>
			</div>
			<div id="bedlevelvisualizer_corrections" class="tab-pane">
				<table>
					<thead>
						<tr>
							<th style="text-align: right; background-color:#f2f2f2;" >Deg.</th>
							<!-- ko foreach:  { data: $root.settingsViewModel.settings.plugins.bedlevelvisualizer.stored_mesh_x(), as: 'Xaxis', noChildContext: true }-->
								<th style="text-align: right; background-color:#f2f2f2; color: green;" data-bind="text: Xaxis"></th>
							<!-- /ko -->
						</tr>
					</thead>
					<tbody>
						<!-- ko foreach: { data: $root.settingsViewModel.settings.plugins.bedlevelvisualizer.stored_mesh(), as: 'Yaxis', noChildContext: true }-->
						<tr>
							<td style="text-align: right; font-weight: bold; background-color:#f2f2f2;" data-bind="text: $root.settingsViewModel.settings.plugins.bedlevelvisualizer.stored_mesh_y()[$index()]"></td>
							<!-- ko foreach:  { data: Yaxis, as: 'Zvalue', noChildContext: true }-->
								<td style="text-align: right;" data-bind="template: {name: 'Zdegree', data: {v:((parseFloat(Zvalue) - parseFloat($root.settingsViewModel.settings.plugins.bedlevelvisualizer.stored_mesh()[0][0]))) * 360 / parseFloat($root.settingsViewModel.settings.plugins.bedlevelvisualizer.screw_hub() || '0.5'), n:1, c:0}}">.</td>
							<!-- /ko -->
						</tr>
						<!-- /ko -->
					</tbody>
				</table>
				<div style="padding-top: 5px;" class="row-fluid">
					<span style="font-weight: bold; color: green;">X - Position</span>
					<span style="font-weight: bold; color: normal;">Y - Position</span>
				</div>
				<div class="row-fluid">
					<span style="color: normal;">Adjustment wheel angle turn direction - </span>
					<span style="color: blue;">turn clockwise</span>
					<span style="color: normal;"> / </span>
					<span style="color: red;">turn anticlockwise</span>
				</div>
				<div style="padding-top: 5px;" class="row-fluid">
					<div class="control-group">
						<label for="screw_hub"><b class="icon icon-info-sign" title="Adjustment screw hub for a full 360Â° turn in millimeters." data-toggle="tooltip"></b> Adjustment screw hub</label>
						<div class="input-append">
							<input type="number" min="0" step="0.05" id="screw_hub" class="input-mini text-right" oninput="this.value = Math.abs(parseFloat(this.value || 0.25));" data-bind="value: settingsViewModel.settings.plugins.bedlevelvisualizer.screw_hub">
							<span class="add-on">mm</span>
							<select class="controls"
									oninput="this.value = Math.abs(parseFloat(this.value || 0.25));"
									type="number"
									size="1"
									data-bind="	value: settingsViewModel.settings.plugins.bedlevelvisualizer.screw_hub,
												options: [{no: 0.25, name:'M1 or M1.2'}, {no: 0.35, name:'M1.6'}, {no: 0.4, name:'M2'},{no: 0.45, name:'M2.5'},{no: 0.5, name:'M3'}, {no: 0.7, name:'M4'}, {no: 0.9, name:'M5'}, {no: 1.0, name:'M6'}, {no: 1.25, name:'M8'}],
												optionsValue: 'no',
												optionsText: 'name',
												valueAllowUnset: true">
							</select>
						</div>
					</div>
				</div>
			</div>
		</div>
	</div>
</div>


