<div class="container span12">
	<div class="tabbable">
		<h4>Bed Visualizer Settings</h4>
		<ul class="nav nav-tabs" id="bedlevelvisualizer_tabs">
			<li class="active"><a data-toggle="tab" href="#bedlevelvisualizer_general">General</a></li>
			<li><a data-toggle="tab" href="#bedlevelvisualizer_stored_data">Stored Data</a></li>
			<li><a data-toggle="tab" href="#bedlevelvisualizer_corrections">Adjustment Wheel Degrees</a></li>
		</ul>
		<div class="tab-content">
			<div id="bedlevelvisualizer_general" class="tab-pane active">
				<div class="control-group">
					<label for="bedlevelvisualizer_command"><i class="icon icon-info-sign" title="GCODE commands to send to printer to retrieve grid data" data-toggle="tooltip"></i> GCODE Create Commands</label>
					<textarea class="input-block-level" id="bedlevelvisualizer_command" rows="6" data-bind="value: $root.command"></textarea>
					<label for="bedlevelvisualizer_command"><i class="icon icon-info-sign" title="GCODE commands to send to printer to read grid data frm EEPROM" data-toggle="tooltip"></i> GCODE Read Commands</label>
					<textarea class="input-block-level" id="bedlevelvisualizer_command" rows="4" data-bind="value: $root.read"></textarea>
					<p style="padding-top: 5px;">If you experience issues with data collection try entering <div class="label">@BEDLEVELVISUALIZER</div> just prior to the command that sends back the mesh data.</p>
				</div>
				<div class="row-fluid">
					<div class="control-group span4">
						<i class="icon icon-info-sign" title="Save/Load mesh data to/from config.yaml" data-toggle="tooltip"></i> Save Mesh <input class="input-checkbox" type="checkbox" id="bedlevelvisualizer_save_mesh" data-bind="checked: $root.save_mesh" style="display: inline-block;margin-bottom: 5px;"></input>
					</div>
					<div class="control-group span2">
						<i class="icon icon-info-sign" title="Flip the mesh data in the X direction." data-toggle="tooltip"></i> Flip X Axis <input class="input-checkbox" type="checkbox" id="bedlevelvisualizer_flipX" data-bind="checked: $root.flipX" style="display: inline-block;margin-bottom: 5px;"></input>
					</div>
					<div class="control-group span3">
						<i class="icon icon-info-sign" title="Make origin point center of bed." data-toggle="tooltip"></i> Use Center Origin <input class="input-checkbox" type="checkbox" id="bedlevelvisualizer_use_center_origin" data-bind="checked: $root.use_center_origin" style="display: inline-block;margin-bottom: 5px;"></input>
					</div>
				</div>
				<div class="row-fluid">
					<div class="control-group span4">
						<i class="icon icon-info-sign" title="Remove row labeling from mesh data." data-toggle="tooltip"></i> Remove Row Labels <input class="input-checkbox" type="checkbox" id="bedlevelvisualizer_stripFirst" data-bind="checked: $root.stripFirst" style="display: inline-block;margin-bottom: 5px;"></input>
					</div>
					<div class="control-group span2">
						<i class="icon icon-info-sign" title="Flip the mesh data in the Y direction." data-toggle="tooltip"></i> Flip Y Axis <input class="input-checkbox" type="checkbox" id="bedlevelvisualizer_flipY" data-bind="checked: $root.flipY" style="display: inline-block;margin-bottom: 5px;"></input>
					</div>
					<div class="control-group span4">
						<i class="icon icon-info-sign" title="Make all z offsets relative to origin point." data-toggle="tooltip"></i> Use Relative Z Offsets <input class="input-checkbox" type="checkbox" id="bedlevelvisualizer_use_relative_offsets" data-bind="checked: $root.use_relative_offsets" style="display: inline-block;margin-bottom: 5px;"></input>
					</div>
				</div>
				<div class="row-fluid">
					<div class="control-group span4">
						<i class="icon icon-info-sign" title="Ignore Bed Level Correction Matrix by enabling this option." data-toggle="tooltip"></i> Ignore Matrix: <input class="input-checkbox" type="checkbox" id="ignore_correction_matrix" data-bind="checked: $root.ignore_correction_matrix" style="display: inline-block;margin-bottom: 5px;"></input>
					</div>
					<div class="control-group span2" title="Timeout value that will stop processing of visualizer in seconds." data-toggle="tooltip">
						<i class="icon icon-info-sign"></i> Timeout
					</div>
					<div class="control-group span4">
						<div class="input-append">
							<input style="width: 3em;" type="number" min="0" step="10" id="bedlevelvisualizer_timeout" class="input-mini text-right" data-bind="value: $root.timeout">
							<div class="add-on">sec</div>
						</div>
					</div>
					<div class="control-group span2">
					</div>
				</div>
			</div>

			<div id="bedlevelvisualizer_stored_data" class="tab-pane">
				<h2>Stored Mesh (Z heigth)</h2>
				<span data-bind="template: {name: 'bedlevelvisualize_meshtable', data: {mesh: $root.mesh_data(), len: 3}}"></span>
				<script type="text/html" id="bedlevelvisualize_meshtable">
					<table>
						<thead>
							<tr>
								<th style="text-align: right; background-color:#f2f2f2;" >y</th>
								<th style="text-align: center; background-color:#f2f2f2; color: normal;" data-bind="attr: { 'colspan': $root.mesh_data_x().length }">
									<!-- ko if: $data.len -->
										Mesh z heigth in:
										<select style="width: 5em;"
										oninput="this.value = Math.abs(parseFloat(this.value || 1.0));"
										type="number"
										size="1"
										data-bind="	value: $root.mesh_unit,
													options: [{mm: 1.0, name:'mm'}, {mm: 10.0, name:'cm'}, {mm: 25.4, name:'in'}],
													optionsCaption: '?',
													optionsValue: 'mm',
													optionsText: 'name',
													valueAllowUnset: false">
										</select>
									<!-- /ko -->
									<!-- ko ifnot: $data.len -->
										<div title="Click on meshpoint to normalize adjustment to that point.<br/>click this clear adjustment." data-toggle="tooltip" data-bind="click: function(){$root.mesh_zero(0);}">Adjustment angle</div>
									<!-- /ko -->
								</th>
							</tr>
						</thead>
						<tbody>
							<!-- ko foreach:  { data: $root.mesh_data_y(), noChildContext: true }-->
								<tr>
									<th style="text-align: right; background-color:#f2f2f2;" data-bind="text: $root.mesh_data_y()[$root.descending()?$root.mesh_data_y().length-1-$index():$index()]"></th>
									<!-- ko foreach:  { data: $parent.mesh[$root.descending()?$root.mesh_data_y().length-1-$index():$index()], as: 'Zvalue', noChildContext: true }-->
										<td style="text-align: right; padding-left: 0.5em;"
											data-bind="
												text: (!$parentContext.$parent.len?Math.abs(parseFloat(Zvalue)):parseFloat(Zvalue)).toFixed($parentContext.$parent.len),
												click: function(){$root.mesh_zero($root.mesh_data()[$root.descending()?$root.mesh_data_y().length-1-$parentContext.$index():$parentContext.$index()][$index()]);},
												style: {'color' : ['blue','black','red'][1+Math.sign(parseFloat(Zvalue))]},
												attr: {'title' : $parentContext.$parent.len ? 'Z height' : !parseFloat(Zvalue) ? '-' : (
																(parseFloat(Zvalue)<0? 'raise' : 'lower') +
																' bed: move wheel ' +
																Math.round(Math.abs(parseFloat(Zvalue))/36)/10 + ' ' +
																'turn'+(!Math.trunc(Math.abs(parseFloat(Zvalue))/360) ? '' : 's') + ' ' +
																(parseFloat(Zvalue)<0 ^ $root.reverse() ? 'clockwise (right)' : 'anticlockwise (left)')
															)
														}">
										</td>
									<!-- /ko -->
								</tr>
							<!-- /ko -->
						</tbody>
						<tfoot>
							<tr>
								<th style="text-align: right; background-color:#f2f2f2; color: green;" >x</th>
								<!-- ko foreach:  { data: ko.utils.range(0,$root.mesh_data_x().length-1), as: 'Xindex', noChildContext: true }-->
									<th style="text-align: right; background-color:#f2f2f2; color: green;" data-bind="text: $root.mesh_data_x()[Xindex]"></th>
								<!-- /ko -->
							</tr>
						</tfoot>
					</table>
					<div style="padding-top: 5px;" class="row-fluid">
						<div class="control-group span2">
							<div style="font-weight: bold; color: green;">x - Position</div>
						</div>
						<div class="control-group span2">
							<div style="font-weight: bold; color: normal;">y - Position</div>
						</div>
						<div class="control-group span8" title="Printer bed leveling screws turn direction." data-toggle="tooltip">
							<!-- ko if: $data.len -->
								<span style="color: normal;">Z height: </span>
								<span style="color: blue;">below offset</span>
								<span style="color: normal;"> / </span>
								<span style="color: red;">above offset</span>
							<!-- /ko -->
							<!-- ko ifnot: $data.len -->
								<span style="color: normal;">Turn direction - </span>
								<span style="color: blue;" data-bind="text: $root.reverse()?'anticlockwise (left)':'clockwise (right)'"></span>
								<span style="color: normal;"> / </span>
								<span style="color: red;"  data-bind="text: !$root.reverse()?'anticlockwise (left)':'clockwise (right)'"></span>
							<!-- /ko -->
						</div>
					</div>
				</script>
				<div class="row-fluid">
					<div class="control-group span4">
						<i class="icon icon-info-sign" title="Display mesh with descending y axis" data-toggle="tooltip"></i> Descending y axis <input class="input-checkbox" type="checkbox" data-bind="checked: $root.descending" style="display: inline-block;margin-bottom: 5px;"></input>
					</div>
				</div>
			</div>

			<div id="bedlevelvisualizer_corrections" class="tab-pane">
				<h2>Bed Alignment (Adjustment Wheel Angle)</h2>
				<span data-bind="template: {name: 'bedlevelvisualize_meshtable', data: {mesh: $root.mesh_adjustment(), len: 0}}"></span>
				<div class="row-fluid">
					<div class="control-group span4">
						<i class="icon icon-info-sign" title="Display on plugin main tab screen" data-toggle="tooltip"></i> Display on tab screen<input class="input-checkbox" type="checkbox" data-bind="checked: $root.showdegree" style="display: inline-block;margin-bottom: 5px;"></input>
					</div>
					<div class="control-group span4">
						<i class="icon icon-info-sign" title="Adjustment screw hub for a full 360° turn in millimeters" data-toggle="tooltip"></i> Imperial screws <input class="input-checkbox" type="checkbox" data-bind="checked: $root.imperial, click: function(){$root.screw_hub(25.4/$root.screw_hub()); return true;}" style="display: inline-block;margin-bottom: 5px;"></input>
					</div>
				</div>
				<div style="padding-top: 5px;" class="row-fluid">
					<div class="control-group span4">
						<i class="icon icon-info-sign" title="Revers the adjustment scres turning direction logig" data-toggle="tooltip"></i> Reverse turn direction <input class="input-checkbox" type="checkbox" data-bind="checked: $root.reverse" style="display: inline-block;margin-bottom: 5px;"></input>
					</div>
					<div class="control-group span3" title="Adjustment screw details." data-toggle="tooltip">
						<div class="input-append">
							<input style="width: 4em;" type="number" min="0" step="0.001" class="input-mini text-right" oninput="this.value = Math.abs(parseFloat(this.value || 0.25));" data-bind="value: $root.screw_hub">
							<div class="add-on" data-bind="text: $root.imperial()?'turns per inch':'mm per turn'"></div>
						</div>
					</div>
					<div class="control-group span3">
						<select style="width: 6em;"
								class="controls"
								oninput="this.value = Math.abs(parseFloat(this.value || 0.25));"
								type="number"
								size="1"
								data-bind="	value: $root.screw_hub,
											options: { false:	[	{no: 0.25, name:'M1 or M1.2'},
																	{no: 0.35, name:'M1.6'},
																	{no: 0.4, name:'M2'},
																	{no: 0.45, name:'M2.5'},
																	{no: 0.5, name:'M3'},
																	{no: 0.7, name:'M4'},
																	{no: 0.9, name:'M5'},
																	{no: 1.0, name:'M6'},
																	{no: 1.25, name:'M8'}],
														true:	[	{no: 64, name: '#1'},
																	{no: 56, name: '#2'},
																	{no: 48, name: '#3'},
																	{no: 40, name: '#4/#5'},
																	{no: 32, name: '#6/#8'},
																	{no: 24, name: '#10/#12'}]}[$root.imperial()],
											optionsCaption: '- select -',
											optionsValue: 'no',
											optionsText: 'name',
											valueAllowUnset: true">
						</select>
					</div>
				</div>
			</div>
		</div>
	</div>
</div>


