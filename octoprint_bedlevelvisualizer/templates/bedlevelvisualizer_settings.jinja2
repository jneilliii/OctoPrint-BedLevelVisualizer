<div class="row-fluid">
	<div class="tabbable">
		<h4>Bed Visualizer Settings <small>Version {{ plugin_bedlevelvisualizer_plugin_version }}</small></h4>
		<ul class="nav nav-tabs" id="bedlevelvisualizer_tabs">
			<li class="active"><a data-toggle="tab" href="#bedlevelvisualizer_mesh_collection">Collection</a></li>
			<li><a data-toggle="tab" href="#bedlevelvisualizer_mesh_visualization">Visualization</a></li>
			<li><a data-toggle="tab" href="#bedlevelvisualizer_stored_data">Data</a></li>
			<li><a data-toggle="tab" href="#bedlevelvisualizer_corrections">Corrections</a></li>
			<li><a data-toggle="tab" href="#bedlevelvisualizer_custom_commands">Commands</a></li>
			<li><a data-toggle="tab" href="#bedlevelvisualizer_support">Support</a></li>
		</ul>
		<div class="tab-content">
			<div id="bedlevelvisualizer_mesh_collection" class="tab-pane active">
				<div class="control-group">
					<label for="bedlevelvisualizer_command"><i class="icon icon-info-sign" title="GCODE commands to send to printer to retrieve grid data" data-toggle="tooltip"></i> GCODE Commands for Mesh Update Process <small class="muted">Firmware specific examples can be found <a href="https://github.com/jneilliii/OctoPrint-BedLevelVisualizer/blob/master/wiki/gcode-examples.md" target="_blank">here</a>.</small></label>
					<textarea class="input-block-level" id="bedlevelvisualizer_command" rows="15" data-bind="value: settingsViewModel.settings.plugins.bedlevelvisualizer.command"></textarea>
				</div>
				<div class="row-fluid">
					<div class="control-group span4">
                        <input class="input-checkbox" type="checkbox" id="bedlevelvisualizer_flipX"
                               title="Flip the mesh data in the X direction." data-toggle="tooltip"
                               data-bind="checked: settingsViewModel.settings.plugins.bedlevelvisualizer.flipX"
                               style="display: inline-block;margin-bottom: 5px;"/> Flip X-Axis <br/>
                        <input class="input-checkbox" type="checkbox" id="bedlevelvisualizer_flipY"
                               title="Flip the mesh data in the Y direction." data-toggle="tooltip"
                               data-bind="checked: settingsViewModel.settings.plugins.bedlevelvisualizer.flipY"
                               style="display: inline-block;margin-bottom: 5px;"/> Flip Y-Axis <br/>
                        <input class="input-checkbox" type="checkbox" id="bedlevelvisualizer_stripFirst"
                               title="Remove row labeling from mesh data." data-toggle="tooltip"
                               data-bind="checked: settingsViewModel.settings.plugins.bedlevelvisualizer.stripFirst"
                               style="display: inline-block;margin-bottom: 5px;"/> Remove Row Labels
					</div>
					<div class="control-group span4">
                        <input class="input-checkbox" type="checkbox" id="bedlevelvisualizer_use_center_origin"
                               title="Make origin point center of bed." data-toggle="tooltip"
                               data-bind="checked: settingsViewModel.settings.plugins.bedlevelvisualizer.use_center_origin"
                               style="display: inline-block;margin-bottom: 5px;"/> Use Center Origin<br/>
                        <input class="input-checkbox" type="checkbox" id="bedlevelvisualizer_use_relative_offsets"
                               title="Make all z offsets relative to origin point." data-toggle="tooltip"
                               data-bind="checked: settingsViewModel.settings.plugins.bedlevelvisualizer.use_relative_offsets"
                               style="display: inline-block;margin-bottom: 5px;"/> Use Relative Z Offsets<br/>
                        <input class="input-checkbox" type="checkbox" id="ignore_correction_matrix"
                               title="Ignore Bed Level Correction Matrix by enabling this option." data-toggle="tooltip"
                               data-bind="checked: settingsViewModel.settings.plugins.bedlevelvisualizer.ignore_correction_matrix"
                               style="display: inline-block;margin-bottom: 5px;"/> Ignore Correction Matrix
					</div>
					<div class="control-group span4">
						<label for="bedlevelvisualizer_rotate">Clockwise Rotation</label>
						<div class="input-append" title="Clockwise rotation angle of visualized mesh to match physical orientation of bed." data-toggle="tooltip">
							<input type="number" min="0" max="270" step="90" id="bedlevelvisualizer_rotate" class="input-mini text-right" data-bind="value: settingsViewModel.settings.plugins.bedlevelvisualizer.rotation">
							<span class="add-on">degs</span>
						</div>
					</div>
				</div>
                <hr/>
				<div class="row-fluid">
					<div class="control-group span4">
                        <input class="input-checkbox" type="checkbox" id="bedlevelvisualizer_save_mesh"
                               title="Save/Load mesh data to/from config.yaml. This does not store your mesh after the collection process to your firmware. Include M500 in your GCODE commands above if you want that to happen."
                               data-toggle="tooltip"
                               data-bind="checked: settingsViewModel.settings.plugins.bedlevelvisualizer.save_mesh"
                               style="display: inline-block;margin-bottom: 5px;"/> Save Mesh
					</div>
					<div class="control-group span4">
                        <input class="input-checkbox" type="checkbox" id="show_webcam"
                               title="Show webcam while collecting mesh data." data-toggle="tooltip"
                               data-bind="checked: settingsViewModel.settings.plugins.bedlevelvisualizer.show_webcam"
                               style="display: inline-block;margin-bottom: 5px;"/> Webcam while processing
					</div>
					<div class="control-group span4">
						<label for="bedlevelvisualizer_timeout">Processing Timeout</label>
						<div class="input-append" title="Timeout value that will stop processing of visualizer in seconds." data-toggle="tooltip">
							<input type="number" min="0" step="10" id="bedlevelvisualizer_timeout" class="input-mini text-right" data-bind="value: settingsViewModel.settings.plugins.bedlevelvisualizer.timeout">
							<span class="add-on">secs</span>
						</div>
					</div>
				</div>
			</div>

			<div id="bedlevelvisualizer_mesh_visualization" class="tab-pane">
				<div class="row-fluid">
					<div class="control-group span3">
						<label for="bedlevelvisualizer_z_offset">Graph Height</label>
						<div class="controls">
							<input type="text" id="bedlevelvisualizer_graph_height" title="How tall the graph area should be. Any acceptable min-height css attribute should work here." data-toggle="tooltip" class="input-small" data-bind="value: settingsViewModel.settings.plugins.bedlevelvisualizer.graph_height" placeholder="450px">
						</div>
					</div>
					<div class="control-group span3">
						<label for="bedlevelvisualizer_z_offset">Z Limits</label>
						<div class="controls">
							<input type="text" id="bedlevelvisualizer_z_offset" title="Comma separated list of integers or real numbers for controlling the z cutoff of the visualized graph in the format of <z-min>,<z-max>. For example the default value is -2,2. This also affects the color map. " data-toggle="tooltip" class="input-small" data-bind="value: settingsViewModel.settings.plugins.bedlevelvisualizer.graph_z_limits">
						</div>
					</div>
					<div class="control-group span3">
						<label for="bedlevelvisualizer_camera_position">Camera Position</label>
						<div class="controls">
							<input type="text" id="bedlevelvisualizer_camera_position" title="Comma separated list of integers or real numbers for controlling the position of the camera in the format of <x>,<y>,<z>. For example the default value is -1.25,-1.25,0.25." data-toggle="tooltip" class="input-small" data-bind="value: settingsViewModel.settings.plugins.bedlevelvisualizer.camera_position">
						</div>
					</div>
					<div class="control-group span3">
						<label for="bedlevelvisualizer_date_locale_format">Date Locale</label>
						<div class="controls">
							<input type="text" id="bedlevelvisualizer_date_locale_format" title="Enter the js locale string for date display format for last stored mesh message. If left blank this will default to your browser's date locale settings." data-toggle="tooltip" class="input-small" data-bind="value: settingsViewModel.settings.plugins.bedlevelvisualizer.date_locale_format">
						</div>
					</div>
                </div>
                <div class="row-fluid">
                    <div class="control-group">
                        <label for="bedlevelvisualizer_colorscale">Colorscale</label>
                        <div class="controls">
                            <input type="text" id="bedlevelvisualizer_colorscale" title="Either an array of percentage and color pairs or a Plotly named colorscale" data-toggle="tooltip" class="input-block-level" data-bind="value: settingsViewModel.settings.plugins.bedlevelvisualizer.colorscale" placeholder='[[0, "rebeccapurple"],[0.4, "rebeccapurple"],[0.45, "blue"],[0.5, "green"],[0.55, "yellow"],[0.6, "red"],[1, "red"]]'>
                            <small class="help-block">Array of percentage/color pairs, ie <code>[[0, "blue"],[1, "red"]]</code> will create a gradient between blue to red. Percentage values are in decimal format and colors can be HTML hex values or color names surrounded by double quotes. You can also use a named color scale from <a href="https://plotly.com/javascript/colorscales/">here</a>. Clear this setting to load the default option and click Save below.</small>
                        </div>
                    </div>
					<div class="control-group">
                        <input class="input-checkbox" type="checkbox" id="snap_shot"
                               title="Enable saving snapshot on every rendering of the graph in png format."
                               data-toggle="tooltip"
                               data-bind="checked: settingsViewModel.settings.plugins.bedlevelvisualizer.save_snapshots"
                               style="display: inline-block;margin-bottom: 5px;"/> Download Snapshots of Rendered Graph
					</div>
				</div>
            </div>

			<div id="bedlevelvisualizer_stored_data" class="tab-pane">
				<span data-bind="template: {name: 'bedlevelvisualize_meshtable', data: {mesh: $root.mesh_data(), len: 3}}"></span>
				<div class="row-fluid" style="padding-top: 10px;">
					<div class="control-group span4">
                        <input class="input-checkbox" type="checkbox" title="Display on plugin main tab screen"
                               data-toggle="tooltip" data-bind="checked: $root.show_stored_mesh_on_tab"
                               style="display: inline-block;margin-bottom: 5px;"/> Display on tab screen
					</div>
					<div class="control-group span4">
                        <input class="input-checkbox" type="checkbox" title="Display mesh with descending y-axis"
                               data-toggle="tooltip" data-bind="checked: $root.descending_y"
                               style="display: inline-block;margin-bottom: 5px;"/> Descending y-axis
					</div>
					<div class="control-group span4">
                        <input class="input-checkbox" type="checkbox" title="Display mesh with descending x-axis"
                               data-toggle="tooltip" data-bind="checked: $root.descending_x"
                               style="display: inline-block;margin-bottom: 5px;"/> Descending x-axis
					</div>
				</div>
			</div>

			<div id="bedlevelvisualizer_corrections" class="tab-pane">
				<span data-bind="template: {name: 'bedlevelvisualize_meshtable', data: {mesh: $root.mesh_adjustment(), len: 0}}"></span>
				<div class="row-fluid" style="padding-top: 10px;">
					<div class="control-group span4">
                        <input class="input-checkbox" type="checkbox" title="Display on plugin main tab screen"
                               data-toggle="tooltip" data-bind="checked: $root.showdegree"
                               style="display: inline-block;margin-bottom: 5px;"/> Display on tab screen
					</div>
					<div class="control-group span4">
                        <input class="input-checkbox" type="checkbox"
                               title="Reverse the adjustment screws turning direction logic" data-toggle="tooltip"
                               data-bind="checked: $root.reverse" style="display: inline-block;margin-bottom: 5px;"/> Reverse turn direction
					</div>
					<div class="control-group span4">
                        <input class="input-checkbox" type="checkbox" id="prusa_adjustments"
                               title="Enable to display the bed leveling adjustment values."
                               data-toggle="tooltip"
                               data-bind="checked: settingsViewModel.settings.plugins.bedlevelvisualizer.show_prusa_adjustments"
                               style="display: inline-block;margin-bottom: 5px;"/> Show Prusa Correction Values
					</div>
				</div>
				<div style="padding-top: 5px;" class="row-fluid">
					<div class="control-group">
                        <label class="row-fluid" style="margin-bottom: 0;"><span class="span4">Adjustment Screw Details</span> <span class="span4"><input
                                class="input-checkbox" type="checkbox"
                                title="List imperial sized screws in drop-down instead of millimeters."
                                data-toggle="tooltip"
                                data-bind="checked: $root.imperial, click: function(){$root.screw_hub(25.4/$root.screw_hub()); return true;}"
                                style="display: inline-block;margin-bottom: 5px;"/> Imperial screws</span></label>
						<div class="controls">
                            <div class="input-prepend input-append span5" style="padding: 3px;" title="Adjustment screw details. Use the drop-down to the right to select a standard size screw." data-toggle="tooltip">
                                <div class="add-on" data-bind="text: $root.imperial()?'turns per inch':'mm per turn'"></div>
                                <input style="width: 4em;" type="number" min="0" step="0.001" class="input-mini text-right" oninput="this.value = Math.abs(parseFloat(this.value || 0.25));" data-bind="value: $root.screw_hub">
                                <select style="width: 6em; box-sizing: content-box;"
                                        class="add-on custom-select"
                                        oninput="this.value = Math.abs(parseFloat(this.value || 0.25));"
                                        type="number"
                                        size="1"
                                        data-bind="	value: $root.screw_hub,
                                                    options: { false:	[	{no: 0.25, name:'M1 or M1.2'},
                                                                            {no: 0.35, name:'M1.6'},
                                                                            {no: 0.4, name:'M2'},
                                                                            {no: 0.45, name:'M2.5'},
                                                                            {no: 0.5, name:'M3'},
                                                                            {no: 0.7, name:'M4'},
                                                                            {no: 0.9, name:'M5'},
                                                                            {no: 1.0, name:'M6'},
                                                                            {no: 1.25, name:'M8'}],
                                                                true:	[	{no: 64, name: '#1'},
                                                                            {no: 56, name: '#2'},
                                                                            {no: 48, name: '#3'},
                                                                            {no: 40, name: '#4/#5'},
                                                                            {no: 32, name: '#6/#8'},
                                                                            {no: 24, name: '#10/#12'}]}[$root.imperial()],
                                                    optionsCaption: '- select -',
                                                    optionsValue: 'no',
                                                    optionsText: 'name',
                                                    valueAllowUnset: true">
                                </select>
                            </div>
						</div>
					</div>
					<div class="control-group span4">
					</div>
				</div>
			</div>

			<div id="bedlevelvisualizer_custom_commands" class="tab-pane">
				<div class="row-fluid">
					<div class="span10">Click on button to configure options. Use the drop-down to select icon.</div>
					<div class="span2" style="text-align: center;"><button class="btn btn-mini" data-bind="click: addCommand" title="Add custom command button"><i class="fa fa-plus"></i> Add</button></div>
				</div>
				<div data-bind="sortable: { data: settingsViewModel.settings.plugins.bedlevelvisualizer.commands, options: { cancel: '.unsortable', handle: '.move_command'} }" class="row-fluid">
					<div class="btn-group" style="margin: 5px;">
						<button type="button" class="btn iconpicker-component" data-bind="click: $root.showEditor, attr: {title: (tooltip() ? tooltip : command)}"><i class="fa-lg" data-bind="css: icon"></i> <span data-bind="text: label"></span></button>
						<button type="button" class="icp icp-dd btn dropdown-toggle" data-selected="fa-car" data-toggle="dropdown" aria-expanded="false" data-bind="iconpicker: icon,iconpickerOptions: {searchInFooter: true, hideOnSelect: true, collision: true}">
							<span class="caret"></span>
							<span class="sr-only">Toggle Dropdown</span>
						</button>
						<div class="dropdown-menu iconpicker-container"></div>
						<button type="button" class="btn btn-mini move_command" title="Move button">
							<i class="fa fa-arrows"></i>
						</button>
						<button type="button" class="btn btn-mini copy_command" data-bind="click: $parent.copyCommand" title="Copy button">
							<i class="fa fa-copy"></i>
						</button>
						<button type="button" class="btn btn-mini btn-danger removeJob" data-bind="click: $parent.removeCommand" title="Delete button">
							<i class="fa fa-times"></i>
						</button>
					</div>
				</div>
			</div>

            <div id="bedlevelvisualizer_support" class="tab-pane">
				<div class="row-fluid">
                    <label class="well">It is extremely important to enable debug logging, restart OctoPrint, and attempt a probing process prior to submitting a bug report. Include the file <code>plugin_bedlevelvisualizer_debug.log</code> from OctoPrint's logging section by downloading it locally and dragging it into your bug report's comment. Check out the <a href="http://github.com/jneilliii/OctoPrint-BedLevelVisualizer/blob/master/wiki/index.md" target="_blank">wiki</a> for explanation of settings and tips.</label>
					<div class="control-group">
                        <input class="input-checkbox" type="checkbox" id="debug_logging"
                               title="Enable additional debug logging." data-toggle="tooltip"
                               data-bind="checked: settingsViewModel.settings.plugins.bedlevelvisualizer.debug_logging"
                               style="display: inline-block;margin-bottom: 5px;"/> Enable Debug Logging:
					</div>
                    <div class="control-group">
                        <div class="controls">
                            <a target="_blank" href="https://github.com/jneilliii/OctoPrint-BedLevelVisualizer/issues/new?assignees=&labels=bug&template=bug_report.md&title=%5BBUG%5D%3A+" class="btn">Bug Report</a>
                            <a target="_blank" href="https://github.com/jneilliii/OctoPrint-BedLevelVisualizer/issues/new?assignees=&labels=enhancement&template=feature_request.md&title=%5BFR%5D%3A+" class="btn">Feature Request</a>
                        </div>
                    </div>
				</div>
            </div>
		</div>
	</div>
</div>

<div id="BedLevelVisulizerCommandEditor" data-bind="with: selected_command" class="modal hide fade">
	<div class="modal-header">
		<a href="#" class="close" data-dismiss="modal" aria-hidden="true">&times;</a>
		<h3>Command Editor</h3>
	</div>
	<div class="modal-body">
		<div class="controls"><label class="control-label">{{ _('Label') }}</label><input type="text" class="input-block-level" data-bind="value: label"/></div>
		<div class="controls"><label class="control-label">{{ _('Tooltip') }}</label><input type="text" class="input-block-level" data-bind="value: tooltip"/></div>
		<div class="controls"><label class="checkbox">{{ _('Enabled While Printing') }}<input type="checkbox" data-bind="checked: enabled_while_printing" title="Enabled While Printing"/></label></div>
		<div class="controls"><label class="checkbox">{{ _('Enabled While Graphing') }}<input type="checkbox" data-bind="checked: enabled_while_graphing" title="Enabled While Graphing"/></label></div>
		<div class="controls"><label class="checkbox">{{ _('Confirm') }}<input type="checkbox" data-bind="checked: confirmation" title="Prompt for Confirmation"/></label></div>
		<!-- ko if: confirmation -->
		<div class="controls"><label class="control-label">{{ _('Message') }}</label><input type="text" class="input-block-level" data-bind="value: message"/></div>
		<!-- /ko -->
		<div class="controls"><label class="control-label">{{ _('Command') }}</label><textarea class="input-block-level" id="terminalcommandsextended_command" rows="4" data-bind="value: command"></textarea></div>
		<div>
			<div><small><a href="#" class="muted" data-bind="toggleContent: { class: 'fa-caret-right fa-caret-down', container: '#BedLevelVisulizerCommandEditor .parameters' }"><i class="fa fa-caret-right"></i> Command Parameters</a></small></div>
			<div class="parameters row-fluid" data-bind="style: { display: input().length > 0 ? 'block' : 'none' }">
				<div class="row-fluid">
					<div class="span4">Label</div>
					<div class="span3">Parameter</div>
					<div class="span4">Default</div>
					<div class="span1"><button class="btn btn-mini" data-bind="click: $root.addParameter" title="Add Command Paramter"><i class="fa fa-plus"></i></button></div>
				</div>
				<!-- ko foreach: input -->
					<div class="row-fluid">
						<div class="span4"><input type="text" class="input-block-level" data-bind="value: label"/></div>
						<div class="span3"><input type="text" class="input-block-level" data-bind="value: parameter"/></div>
						<div class="span4"><input type="text" class="input-block-level" data-bind="value: value"/></div>
						<div class="span1">
							<div class="btn-group" style="padding-top: 3px;">
								<button class="btn btn-mini" data-bind="click: $root.insertParameter" title="Append to End of Command Input Above"><i class="fa fa-plus"></i></button>
								<button class="btn btn-mini btn-danger" data-bind="click: $root.removeParameter" title="Remove Command Parameter"><i class="fa fa-times"></i></button>
							</div>
						</div>
					</div>
				<!-- /ko -->
			</div>
		</div>
	</div>
	<div class="modal-footer">
		<div class="row-fluid" style="text-align: center;">
			<div class="btn-group" style="display: inline-block; margin-left: 0px;">
			<!-- ko foreach: input -->
				<span style="cursor: default" data-bind="text: label" class="btn"></span>
				<input type="text" class="input-mini btn active" style="cursor: text;" data-bind="attr: {placeholder: label}, value: value">
			<!-- /ko -->
				<button type="button" class="btn" data-dismiss="modal" data-bind="attr: {title: (tooltip() ? tooltip : command)}"><i class="fa-lg" data-bind="css: icon"></i> <span data-bind="text: label"></span></button>
			</div>
		</div>
	</div>
</div>
